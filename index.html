<!DOCTYPE html>
<html>
  <head>
    <title>Socket.IO Chat</title>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      var socket = io();
      var myId = ""; // Variable für die eigene ID
      window.onload = function () {
        var form = document.getElementById("form");
        var input = document.getElementById("input");

        form.addEventListener("submit", function (e) {
          e.preventDefault();
          if (input.value) {
            // Sende die Nachricht zusammen mit der eigenen ID
            socket.emit("chat message", { msg: input.value, id: myId });
            addMessage(input.value, "sent"); // Füge die eigene Nachricht hinzu
            input.value = "";
          }
        });

        socket.on("chat message", function (data) {
          // Überprüfe, ob die Nachricht von dir selbst oder von jemand anderem stammt
          if (data.id === myId) {
            addMessage(data.msg, "sent");
          } else {
            addMessage(data.msg, "received");
          }
        });

        socket.on("your id", function (id) {
          myId = id; // Speichere die eigene ID
          document.getElementById("userIdDisplay").textContent =
            "Deine ID: " + id;
        });

        function addMessage(msg, type) {
          var item = document.createElement("li");
          item.textContent = msg;
          item.className = type; // Füge die Klasse hinzu
          document.getElementById("messages").appendChild(item);
          window.scrollTo(0, document.body.scrollHeight);
        }
      };
    </script>
  </head>
  <body>
    <div id="userIdDisplay"></div>
    <ul id="messages"></ul>
    <form id="form" action="">
      <input id="input" autocomplete="on" /><button>Send</button>
    </form>
  </body>
  <style>
    body,
    ul,
    form,
    input,
    button {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Arial", sans-serif; /* Verspielte Schriftart, als Fallback Arial */
      background-color: #f0f0f0; /* Heller Hintergrund */
    }

    ul#messages {
      list-style-type: none; /* Entfernt Bulletpoints */
      width: 100%;
      padding: 20px; /* Etwas Abstand nach innen */
      height: 300px; /* Feste Höhe für den Nachrichtenbereich */
      overflow-y: scroll; /* Erlaubt Scrollen, wenn zu viele Nachrichten */
      border: 1px solid #ddd; /* Leichter Rahmen */
      border-radius: 10px; /* Abgerundete Ecken */
      background-color: #fff; /* Weißer Hintergrund für den Nachrichtenbereich */
      margin-bottom: 10px; /* Abstand zum Formular */
    }

    form#form {
      display: flex; /* Flexbox für innere Elemente */
      gap: 10px; /* Abstand zwischen den Elementen */
    }

    input#input {
      flex-grow: 1; /* Nimmt verfügbaren Platz ein */
      padding: 10px; /* Bequemer Textabstand */
      border: 2px solid #aaa; /* Sichtbarer Rahmen */
      border-radius: 20px; /* Stark abgerundete Ecken */
    }

    button {
      background-color: aqua; /* Helle, auffällige Farbe */
      border: none; /* Kein Rahmen */
      padding: 10px 20px; /* Vertikaler und horizontaler Abstand */
      border-radius: 20px; /* Abgerundete Ecken */
      cursor: pointer; /* Zeigerhand beim Überfahren */
      font-weight: bold; /* Fettgedruckter Text */
    }

    button:hover {
      background-color: #7fffd4;
    }

    li.sent {
      text-align: right;
      margin-left: 50rem;
      background-color: #dcf8c6;
    }
    li.received {
      text-align: left;
      background-color: #fff;
    }
  </style>
</html>
